---
title: "What is a Histogram"
description: "A histogram is a graphical representation of the distribution of numerical data. It is an estimate of the probability distribution of a continuous variable (quantitative variable) and was first introduced by Karl Pearson."
date: December 24, 2024
---
[![Click to use](/image/blog/bg/chat2db1.png)](https://app.chat2db.ai/)
# What is a Histogram

## Introduction to Histograms

A **histogram** is a graphical representation of the distribution of numerical data. It is an estimate of the probability distribution of a continuous variable (quantitative variable) and was first introduced by Karl Pearson. In the context of databases, histograms are used to understand the distribution of values within a column, which can help in optimizing query performance and ensuring that the database's query optimizer makes informed decisions about how to execute queries.

### Key Characteristics

- **Distribution Visualization:** Shows the frequency of occurrence of different values or ranges of values.
- **Query Optimization:** Helps the database optimizer choose efficient execution plans.
- **Data Analysis:** Useful for understanding the characteristics of data, such as skewness and outliers.
- **Performance Tuning:** Assists in identifying columns that might benefit from indexes or other optimizations.

## Types of Histograms in Databases

Databases like Oracle provide several types of histograms to capture different distributions:

1. **Height-Balanced Histogram:** Divides the data into buckets with approximately equal height (frequency).
2. **Frequency Histogram:** Captures the exact frequency of each distinct value in the column.
3. **Hybrid Histogram:** Combines elements of both height-balanced and frequency histograms.
4. **Top-Frequency Histogram:** Focuses on the most frequent values in the column.

## How Histograms Work in Databases

Histograms store information about the distribution of values in a column, which can be used by the query optimizer to make better decisions. For example, if a column has a skewed distribution (some values occur much more frequently than others), the optimizer can use this information to avoid full table scans and instead use indexes or other optimized access methods.

### Example Scenario

Consider a `Sales` table with a `product_id` column where some products are sold much more frequently than others. A histogram on this column would help the optimizer understand this skew and choose the best execution plan for queries involving `product_id`.

## Creating Histograms in SQL

### Oracle Database

In Oracle, you can create histograms using the `DBMS_STATS.GATHER_TABLE_STATS` procedure. Hereâ€™s how you can do it:

#### Syntax for Gathering Statistics with Histograms

```sql
BEGIN
   DBMS_STATS.GATHER_TABLE_STATS (
      ownname => 'HR',               -- Schema name
      tabname => 'SALES',            -- Table name
      method_opt => 'FOR COLUMNS SIZE AUTO product_id', -- Automatically determine histogram settings for product_id
      cascade => TRUE                -- Gather statistics on indexes as well
   );
END;
/
```

#### Explanation

- **ownname:** Specifies the schema name where the table resides.
- **tabname:** The name of the table for which to gather statistics.
- **method_opt:** Specifies options for gathering histograms. `'FOR COLUMNS SIZE AUTO product_id'` lets Oracle decide the best histogram settings for the `product_id` column.
- **cascade:** If set to `TRUE`, it gathers statistics on related indexes as well.

### Checking Histogram Information

To check if histograms have been created and to view their details, you can query the `USER_TAB_COL_STATISTICS` view:

```sql
SELECT 
    column_name,
    num_distinct,
    density,
    num_buckets,
    histogram
FROM 
    user_tab_col_statistics
WHERE 
    table_name = 'SALES';
```

#### Result Example

| COLUMN_NAME | NUM_DISTINCT | DENSITY | NUM_BUCKETS | HISTOGRAM      |
|-------------|--------------|---------|-------------|----------------|
| PRODUCT_ID  | 100          | 0.01    | 254         | HYBRID         |

### PostgreSQL Database

PostgreSQL does not support histograms directly in the same way as Oracle, but you can simulate them using custom queries. For example, to create a frequency histogram for a column `product_id` in the `sales` table:

```sql
SELECT 
    product_id,
    COUNT(*) AS frequency
FROM 
    sales
GROUP BY 
    product_id
ORDER BY 
    frequency DESC;
```

This query will return the frequency of each `product_id` in descending order, effectively creating a frequency histogram.

### MySQL Database

MySQL also does not natively support histograms in the same manner as Oracle, but you can manually create them using similar techniques. For instance, to create a frequency histogram for a column `product_id` in the `sales` table:

```sql
SELECT 
    product_id,
    COUNT(*) AS frequency
FROM 
    sales
GROUP BY 
    product_id
ORDER BY 
    frequency DESC;
```

### Microsoft SQL Server

In SQL Server, you can create histograms using the `CREATE STATISTICS` statement with the `WITH FULLSCAN` option to ensure accurate statistics:

```sql
CREATE STATISTICS stats_product_id ON sales(product_id) WITH FULLSCAN;
```

To view the histogram information, you can use the `DBCC SHOW_STATISTICS` command:

```sql
DBCC SHOW_STATISTICS ('sales', 'stats_product_id');
```

## Benefits of Using Histograms

- **Optimized Query Plans:** Helps the query optimizer choose the most efficient execution plans.
- **Improved Performance:** Reduces the likelihood of suboptimal query execution paths.
- **Resource Utilization:** Enhances resource allocation and utilization by providing accurate data distribution insights.
- **Maintaining Integrity:** Ensures that the optimizer's assumptions remain aligned with the actual state of the data.

## Conclusion

Histograms are valuable tools for understanding and optimizing the performance of queries in database systems. By capturing the distribution of values in columns, they enable the query optimizer to make more informed decisions, leading to faster and more efficient query execution. Understanding how to create and manage histograms can significantly benefit database administrators and developers working with large datasets.

---

## Chat2DB - AI Text2SQL Tool for Easy Database Management

[![Click to use](/image/blog/chat2db.png)](https://app.chat2db.ai/)

## What can Chat2DB do?

- [AI SQL Editor](https://chat2db.ai/feature/AI%20SQL%20Editor)
- [AI SQL Query Generator](https://chat2db.ai/feature/AI%20SQL%20Query%20Generator)
- [Analyze Excel Data with AI](https://chat2db.ai/feature/Analyze%20Excel%20Data%20with%20AI)
- [Best AI Tool for Data Analysis](https://chat2db.ai/feature/Best%20AI%20Tool%20for%20Data%20Analysis)
- [AI Dashboard with Chat2DB](https://chat2db.ai/feature/AI%20Dashboard%20with%20Chat2DB)
- [AI Database Client](https://chat2db.ai/feature/AI%20Database%20Client)
