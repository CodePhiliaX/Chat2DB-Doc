---
title: "What are CUBE and ROLLUP Operators"
description: "The CUBE and ROLLUP operators in SQL are used to generate summary (aggregated) data for multiple levels of grouping."
date: December 24, 2024
---

# What are CUBE and ROLLUP Operators

## Introduction to CUBE and ROLLUP

The **CUBE** and **ROLLUP** operators in SQL are used to generate summary (aggregated) data for multiple levels of grouping. They are extensions of the `GROUP BY` clause and are particularly useful in data analysis, business intelligence, and reporting scenarios where you need to perform multi-dimensional analysis on your data.

### Key Characteristics

- **Aggregation:** Both operators calculate aggregated values based on specified columns.
- **Grouping Levels:** They provide different levels of grouping, allowing for more comprehensive analysis.
- **Hierarchical Aggregation:** Particularly with ROLLUP, they can create hierarchical summaries.

## CUBE Operator

The **CUBE** operator generates a result set that includes all possible combinations of the specified grouping columns, including subtotals and grand totals. This allows for a full cross-tabulation of the data.

### Syntax

```sql
SELECT column1, column2, ..., aggregate_function(column)
FROM table_name
GROUP BY CUBE (column1, column2, ...);
```

### Example Scenario

Consider an `orders` table:

| order_id | product | region | sales |
|----------|---------|--------|-------|
| 1        | A       | North  | 100   |
| 2        | B       | North  | 200   |
| 3        | A       | South  | 150   |
| 4        | B       | South  | 250   |

Using CUBE to analyze sales by `product` and `region`:

```sql
SELECT product, region, SUM(sales) AS total_sales
FROM orders
GROUP BY CUBE(product, region);
```

This query will return results that include:

- Sales grouped by `product` only.
- Sales grouped by `region` only.
- Sales grouped by both `product` and `region`.
- Grand totals for all sales.

#### Result Set

| product | region | total_sales |
|---------|--------|-------------|
| A       | North  | 100         |
| A       | South  | 150         |
| A       | NULL   | 250         | -- Subtotal for Product A
| B       | North  | 200         |
| B       | South  | 250         |
| B       | NULL   | 450         | -- Subtotal for Product B
| NULL    | North  | 300         | -- Subtotal for Region North
| NULL    | South  | 400         | -- Subtotal for Region South
| NULL    | NULL   | 700         | -- Grand Total

## ROLLUP Operator

The **ROLLUP** operator is similar to CUBE but it creates a hierarchical aggregation, meaning it provides subtotals and grand totals in a specific order. It typically aggregates from right to left, generating partial sums at each level.

### Syntax

```sql
SELECT column1, column2, ..., aggregate_function(column)
FROM table_name
GROUP BY ROLLUP (column1, column2, ...);
```

### Example Scenario

Using the same `orders` table as above, applying ROLLUP for hierarchical aggregation:

```sql
SELECT product, region, SUM(sales) AS total_sales
FROM orders
GROUP BY ROLLUP(product, region);
```

This query will return results that include:

- Sales grouped by `product` and `region`.
- Subtotals for each `product`.
- Grand totals for all sales.

#### Result Set

| product | region | total_sales |
|---------|--------|-------------|
| A       | North  | 100         |
| A       | South  | 150         |
| A       | NULL   | 250         | -- Subtotal for Product A
| B       | North  | 200         |
| B       | South  | 250         |
| B       | NULL   | 450         | -- Subtotal for Product B
| NULL    | NULL   | 700         | -- Grand Total

Notice that unlike CUBE, ROLLUP does not generate subtotals for `region` alone because it follows a strict hierarchical order.

## Benefits of Using CUBE and ROLLUP

- **Comprehensive Analysis:** Provides a wide range of aggregations, making it easier to explore data from multiple angles.
- **Efficiency:** Reduces the need for multiple queries to obtain different levels of aggregation.
- **Flexibility:** Offers flexibility in how data is summarized, supporting various reporting needs.

## Practical Example

### Analyzing Sales Data

Suppose you want to analyze sales data across multiple dimensions such as `year`, `quarter`, and `product`.

```sql
-- Using CUBE for full cross-tabulation
SELECT year, quarter, product, SUM(sales) AS total_sales
FROM sales_data
GROUP BY CUBE(year, quarter, product);

-- Using ROLLUP for hierarchical aggregation
SELECT year, quarter, product, SUM(sales) AS total_sales
FROM sales_data
GROUP BY ROLLUP(year, quarter, product);
```

In this example:
- The CUBE operation would provide a detailed breakdown of sales across all combinations of `year`, `quarter`, and `product`, along with all possible subtotals and grand totals.
- The ROLLUP operation would give a hierarchical view starting from detailed sales data and progressively summarizing up to yearly totals.

## Conclusion

The CUBE and ROLLUP operators are powerful tools for generating multi-level aggregated reports directly within SQL. By understanding how these operators work and when to apply them, you can streamline data analysis and reporting processes, providing deeper insights into your data with less effort. Choosing between CUBE and ROLLUP depends on whether you require full cross-tabulation or hierarchical aggregation for your specific analysis needs.

---

## Chat2DB - AI Text2SQL Tool for Easy Database Management

[![Click to use](/image/blog/chat2db.png)](https://app.chat2db.ai/)

## What can Chat2DB do?

- [AI SQL Editor](https://chat2db.ai/feature/AI%20SQL%20Editor)
- [AI SQL Query Generator](https://chat2db.ai/feature/AI%20SQL%20Query%20Generator)
- [Analyze Excel Data with AI](https://chat2db.ai/feature/Analyze%20Excel%20Data%20with%20AI)
- [Best AI Tool for Data Analysis](https://chat2db.ai/feature/Best%20AI%20Tool%20for%20Data%20Analysis)
- [AI Dashboard with Chat2DB](https://chat2db.ai/feature/AI%20Dashboard%20with%20Chat2DB)
- [AI Database Client](https://chat2db.ai/feature/AI%20Database%20Client)
