---
image: ""
description: "この記事では、SQLを書かずに専門的なデータ分析ができるツール、Chat2DBの使い方を説明します。"
date: September 30, 2024
---

# SQLコードを使用してテーブルを作成する方法

SQLは、テーブルデータの操作だけでなく、データベースとテーブルに関連するすべてのタスク（テーブルの作成や変更など）を管理するためにも使用されます。テーブルを作成する一般的な方法は2つあります：

1. **インタラクティブツールを使用する**：ほとんどのデータベース管理システム（DBMS）には、ユーザーがグラフィカルユーザーインターフェースを通じてデータベーステーブルを作成および管理できるインタラクティブツールが付属しています。
2. **SQLステートメントを使用する**：テーブルはまた、直接SQLステートメントを通じても作成および管理できます。

プログラムでテーブルを作成するには、SQLの`CREATE TABLE`ステートメントを使用することができます。インタラクティブツールを使用している場合でも、背景でSQLステートメントが実行されていることに注意してください。ツールはこれらのステートメントを自動的に生成し実行してくれるので、手動で書く必要はありません（既存のテーブル構造を変更する場合も同様です）。

`CREATE TABLE`ステートメントを使用すると、列、データ型、制約などのテーブルの構造を定義することができます。この記事では、`CREATE TABLE`ステートメントを使用してテーブルを作成する方法について、実際の例を交えて解説します。

## SQL CREATE TABLE ステートメントの基本的な構文

`CREATE TABLE`ステートメントの基本的な構文は以下の通りです：

```sql
CREATE TABLE table_name (
    column1 datatype [constraint],
    column2 datatype [constraint],
    ...
);
```

- `テーブル名`：作成したいテーブルの名前。
- `列1`, `列2` など：テーブルの列の名前。
- `データ型`：各列のデータ型。例えば、整数用の`INT`、可変長文字列用の`VARCHAR`、日付値用の`DATE`など。
- `制約`：オプションの制約。例えば、`NOT NULL`（null値を防ぐ）、`PRIMARY KEY`（プライマリキーを定義する）、または`FOREIGN KEY`（外部キー関係を強制する）など。

新しいテーブルを作成するとき、テーブル名はすでに存在してはいけません。それ以外の場合、エラーになります。既存のテーブルを誤って上書きしてしまうことを避けるために、SQLではテーブルを再作成する前に手動で削除する必要があります。

```sql
DROP TABLE IF EXISTS user;
```

## データ型

`CREATE TABLE`ステートメントを使用するとき、各列に適切なデータ型を割り当てる必要があります。以下は一般的なデータ型の一覧です：

### 整数型

- `INT`：4バイトの整数で、-2147483648から2147483647までの値を格納できます。
- `BIGINT`：8バイトの大容量整数で、より広い範囲の値を格納できます。
- `SMALLINT`：2バイトの小容量整数で、通常-32768から32767までの値を格納できます。

### 文字列型

- `VARCHAR(n)`：可変長文字列で、`n`は最大長を表します。たとえば、`VARCHAR(50)`は最大50文字まで保持できます。
- `CHAR(n)`：固定長文字列型で、文字列が定義された長さ`n`よりも短い場合はスペースで埋められます。
- `TEXT`：大量のテキストデータを保存するために使用されます。

### 日付と時間型

- `DATE`：`YYYY-MM-DD`形式で日付を保存します。
- `TIME`：`HH:MM:SS`形式で時間を保存します。
- `DATETIME`：`YYYY-MM-DD HH:MM:SS`形式で日付と時間を保存します。

### その他の型

- `BOOLEAN`：ブーリアン値（`TRUE`または`FALSE`）を保存します。
- `DECIMAL(p,s)`：固定小数点数を保存し、`p`は総桁数、`s`は小数点以下の桁数を表します。たとえば、`DECIMAL(10,2)`は10桁の数字を保持でき、そのうち2桁が小数部分に使用されます。

## 制約

制約はデータの整合性を確保し、テーブル内のデータに対して特定のルールを定義するために使用されます。以下は一般的に使用される制約の一部です：

### NOT NULL

`NULL`値は欠落または未定義のデータを表します。`NULL`値を許可する列では、その列の値なしで行を挿入することができます。一方、`NOT NULL`として定義された列では、行を挿入または更新するときに値を提供する必要があります。テーブル内の各列は、テーブルの構造に基づいて`NULL`を許可するか`NOT NULL`として定義されます。たとえば：

```sql
CREATE TABLE customers(
    customer id INT PRIMARY KEY,
    customer name VARCHAR(50)NOT NULL,
    email VARCHAR(100)
);
```

上記の例では、`customer_name`列は`NOT NULL`としてマークされ、テーブルにデータを挿入するときに値が必要となります。

`NOT NULL`制約が明示的に設定されていない場合、多くのDBMSは列が`NULL`値を許可することをデフォルトとして扱いますが、これはすべてのDBMSで一貫しているわけではありません。

さらに、`NULL`値を許可しない列のみがプライマリキーとして使用できます。`NULL`値を許可する列は一意の識別子として機能できません。なぜなら、`NULL`は欠落または不明なデータを表し、一意性を保証することはできないからです。

### PRIMARY KEY

プライマリキーは、テーブル内の各行が一意に識別可能であることを確保するために使用されます。テーブルには1つのプライマリキーしか持てず、プライマリキー列の値は重複なく一意でなければなりません。たとえば：

```sql
CREATE TABLE orders(
    order id INT PRIMARY KEY,
    customer id INT,
    order date DATE
);
```

この場合、`order_id`列はプライマリキーとして設定され、すべての注文が一意の識別子を持つことが保証されます。

### FOREIGN KEY

外部キーは、2つのテーブル間の関係を作成するために使用されます。外部キー列の値は、別のテーブルのプライマリキー列の既存の値に対応する必要があります。たとえば：

```sql
CREATE TABLE orders(
    order id INT PRIMARY KEY,
    customer id INT,
    order date DATE,
    FOREIGN KEY(customer id)REFERENCES customers(customer id)
);
```

この場合、`orders`テーブルの`customer_id`列は外部キーであり、`customers`テーブルの`customer_id`列を参照します。これにより、`orders`テーブルに追加されるすべての顧客IDが`customers`テーブルに存在することが保証されます。

### UNIQUE

この制約は、列の値が一意であることを保証しますが、`NULL`値は許可されます。たとえば：

```sql
CREATE TABLE users(
    user_id INT PRIMARY KEY,
    username VARCHAR(50)UNIQUE,
    email VARCHAR(100)
);
```

この場合、`username`列は一意としてマークされ、同じユーザー名を持つ2人のユーザーが存在することはできません。

### CHECK

この制約は、列の値が特定の条件を満たすことを強制するために使用されます。たとえば：

```sql
CREATE TABLE employees(
    employee id INT PRIMARY KEY,
    age INT,
    CHECK(age >= 18)
);
```


この場合、`age`列は18歳以上であることを制約で強制します。

## デフォルト値の設定

SQLでは、行を挿入するときに値が提供されない場合、DBMSが自動的にデフォルト値を割り当てるように設定できます。`CREATE TABLE`ステートメントの列定義内で`DEFAULT`キーワードを使用してこれを指定できます。たとえば：

```sql
CREATE TABLE user(
    id INT PRIMARY KEY,
    name VARCHAR(50) NOT NULL,
    email VARCHAR(100),
    quantity INT default 1
);
```

このステートメントは、注文ごとのアイテム数を表す`quantity`列を持つ`user`テーブルを作成します。ここでは、`DEFAULT 1`が追加され、値が提供されない場合にDBMSが数量1を割り当てるよう指示しています。デフォルト値は、日付やタイムスタンプフィールドによく使用されます。

たとえば、システム日付を参照する関数や変数を使用することで、システム日付をデフォルトとして設定できます。

MySQLでは、ユーザーは`DEFAULT CURRENT_DATE()`を使用できます。Oracleでは`DEFAULT SYSDATE`、SQL Serverでは`DEFAULT GETDATE()`を使用します。

## 実践例

たとえば、学生情報を保存するための`students`というテーブルを作成する必要があるとしましょう。テーブルの構造は以下の通りです：

| 列名   | データ型                        | 制約              |
| ------ | ------------------------------- | ----------------- |
| id     | INT                             | PRIMARY KEY       |
| name   | VARCHAR(50)                     | NOT NULL          |
| age    | INT                             | CHECK (age >= 18) |
| gender | ENUM('male', 'female', 'other') | NOT NULL          |
| major  | VARCHAR(50)                     |                   |

Chat2DB AIを使用すると、テーブル名と列の詳細を自然言語で入力することで、即座にSQLステートメントを生成することができます。

![画像説明](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/zntdfo775q8ziyccono0.png)

実行をクリックすると、テーブルの作成が成功します：

![画像説明](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/y4teoy03a4tk8bzzlaew.png)

これで、テーブルにデータを挿入し始めることができます。たとえば：

![画像説明](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/3y77ojt7ha991bvsqhi7.png)

もし制約に違反するデータ（たとえば18歳未満の学生）を挿入しようとすると、データベースは操作を拒否し、エラーメッセージを返します。

![画像説明](https://dev-to-uploads.s3.amazonaws.com/uploads/articles/s36aul06rtryxj20ajs4.png)

## 注意点

### 1. 適切なデータ型を選択する

必要なものに合ったデータ型を選ぶことは重要です。これにより、ストレージの浪費や不正確さを避けることができます。たとえば、列が2つの可能な値（0と1）しか持たない場合、`BOOLEAN`型を使用する方が`INT`型よりも適しています。

### 2. 適切な制約を設定する

制約はデータの整合性と一貫性を維持しますが、あまりにも多くの制約や厳格すぎる制約を使用すると、データの挿入や更新が遅くなる可能性があります。制約は現実世界のビジネス要件とデータの性質に基づいて定義してください。

### 3. 将来的なスケーラビリティを考慮する

テーブルを設計するときは、将来的なビジネスの変化を考慮して、テーブルの拡張が容易になるように設計してください。余分な列を予約したり、柔軟なデータ型を使用したりすることで、成長に対応できます。

### 4. 命名規則に従う

テーブルと列に意味のある名前を使用し、一貫した命名規則に従ってコードを読みやすく保守しやすいようにしてください。たとえば、テーブルには複数形の名前を使用し、列には名詞を使用することができます。

## 結論

SQLの`CREATE TABLE`ステートメントは、シンプルかつ効果的な方法でテーブルを作成することができます。この記事では、`CREATE TABLE`ステートメントの基本的な構文、データ型、制約、デフォルト値の設定、およびいくつかの実践例について解説しました。これらの知識を活用して、効率的かつ堅牢なデータベース設計を行ってください。

## Chat2DB Proの体験を始めましょう

強力でAIベースのデータベース管理ツールをお探しの方は、ぜひChat2DBをご試用ください！データベース管理者、開発者、データアナリストを問わず、Chat2DBはAIの強力な機能を活用してあなたの仕事を簡略化します。

👉[今すぐChat2DB Proの30日間無料トライアルを体験](https://chat2db.ai/pricing)、全てのプレミアム機能をお楽しみください。