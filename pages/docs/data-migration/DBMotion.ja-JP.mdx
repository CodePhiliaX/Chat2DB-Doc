# データ転送

## 操作ガイド

#### 1. プラグインのインストール

Chat2DB を開き、左側のツールバーのプラグイン アイコンをクリックし、右側の「インストール/更新」プラグイン ボタンをクリックして、「インストール」をクリックします。

!['プラグイン'](/image/plugins/plugin01.png)

#### 2. プラグインを開きます

「起動」をクリックしてプラグインを開き、プラグインがロードされるまで待ちます。

!['起動'](/image/plugins/plugin02.png)

#### 3. タスクの作成

!['作成'](/image/plugins/plugin03.png)

1. 「名前」フィールドにタスクの名前を入力します。たとえば、task-01qu6D。
2. 必要に応じて、仮想マシンの仕様を選択します。オプションには、極小、小、中、大があります。デフォルトの選択は「極小」です。
- 各仕様の説明:
- Tiny: 2 コアと 4G メモリ、移行用に 1 スレッドを使用する最小の仕様。
- 小、中、大の仕様により、需要に応じてリソースが増加します。

3. **ソース データベース エンジン**

- ソース データベース エンジンのタイプを選択します。この例では、MySQL が選択されています。
- サポートされているバージョンには、5.6、5.7、8.0 が含まれます。
- サポートされているデータベースの種類には、自己構築データベース、ECS 自己構築データベース、クラウド データベースが含まれます。

4. **ターゲット データベース エンジン**

- ターゲットのデータベース エンジンの種類を選択します。この例では、MySQL が選択されています。
- サポートされているバージョンには、5.6、5.7、8.0 が含まれます。
- サポートされているデータベースの種類には、自己構築データベース、ECS 自己構築データベース、クラウド データベースが含まれます。

!['作成'](/image/plugins/plugin04.png)

必要な情報をすべて入力したら、ページの右下隅にある「作成」ボタンをクリックして新しいタスクを作成します。

!['作成'](/image/plugins/plugin05.png)


#### 4. ソース データベースとターゲット データベースを選択します

1. **データベースの種類**:
- 「ソース情報」セクションで元のデータベースの種類を選択します。この例では「MySQL」を選択しました。
- 同様に、「ターゲット情報」セクションで、データの移行先のターゲット データベースの種類を選択します。ここでは同様に「MySQL」を選択します。
2. **データベース IP:ポート**:
- 「ソース情報」セクションに元のデータベースの IP アドレスとポート番号を入力します。
- 「ターゲット情報」セクションには、ターゲット データベースの IP アドレスとポート番号を指定する必要があります。
3. **アカウントとパスワード**:
- 「ソース情報」セクションでは、元のデータベースにアクセスするためのユーザー名とパスワードを入力する必要があります。ユーザー名のデフォルトは root です。
- 「ターゲット情報」セクションでは、ターゲット データベースへのアクセスに使用するユーザー名とパスワードを入力する必要があります。
- ユーザー名がわからない場合は、以下の「認証スクリプト」操作をクリックして、承認されたユーザーを取得できます。
4. **SSL 配送**:
- データベースが SSL 暗号化接続で構成されている場合は、SSL 送信を有効にすることを選択できます。それ以外の場合は、無効のままにしてください。
5. **接続のテスト**:
- 必要な情報をすべて入力した後、「接続のテスト」をクリックして、入力した情報が正しいこと、およびデータベースに正常に接続できることを確認できます。

!['test_connection'](/image/plugins/plugin06.png)

#### 5. 移行オプション

1. **オブジェクト**:
- この領域には一連のデータベース名がリストされます。これらの項目をチェックすることで、どのデータベース テーブル、ビュー、関数、ストアド プロシージャ、トリガーなどを移行プロセスに含めるかを決定できます。

!['移行'](/image/plugins/plugin061.png)

2. **移行**:

**速度**: 移行速度を選択できます。デフォルトは「無制限」です。これは、速度制限がないことを意味します。移行速度を制限する必要がある場合は、ここで変更できます。

- **移行タイプ**: 「オブジェクト」、「データ」、および「増分同期」の 3 つのオプションが提供されます。ニーズに応じて、移行するオブジェクト定義、データ、または増分同期を選択できます。
- 「オブジェクト」: テーブル、ビューなど、移行されたデータベース内のオブジェクトを表します。
- `Data`: 移行データベース内のデータを表します。
- 「増分同期」: 増分同期を示し、最後の移行以降に変更されたコンテンツのみを移行します。

**同期ポリシー**: このセクションでは、同期ポリシーを指定できます。

- **同期トポロジ**: 一方向または双方向の同期を選択できます。
- `unidirection`: 一方向の同期。データはソース データベースからのみ送信されます ターゲットデータベースへの流れ。
- 「双方向」: 双方向同期。データは 2 つのデータベース間を流れることができます。
- **競合ポリシー**: 競合が発生した場合の競合の処理方法。
- 「カバーして続行」: 既存のデータを上書きして移行を続行します。
- 「無視して続行」: 競合を無視して移行を続行します。
- 「エラーを報告して停止」: エラーを報告して移行を停止します。
- **DDL のフィルター**: データ定義言語 (DDL) ステートメントをフィルターで除外するかどうか。 DDL は、データベース構造の作成、変更、削除によく使用されます。

3. **移行オブジェクト構成ファイルのアップロード** / **テンプレート ファイルのダウンロード**:
- 移行オブジェクトの設定ファイルを準備している場合は、「移行オブジェクト設定ファイルのアップロード」をクリックしてアップロードできます。
- 手動編集用にテンプレート ファイルをダウンロードする必要がある場合は、[テンプレート ファイルをダウンロード] をクリックします。

!['移行'](/image/plugins/plugin07.png)

4. **高度な構成**:
- このリンクをクリックして、より詳細な構成ページに入り、移行タスクの高度なカスタマイズを実行します。

!['移行'](/image/plugins/plugin08.png)
!['移行'](/image/plugins/plugin09.png)

5. **確認情報**:
- 必要な情報をすべて入力したら、「次へ」をクリックして次のステップに進みます。

データベースの移行を実行する前に、すべてのオプション、特に競合ポリシーと同期ポリシーを注意深く確認してください。これらのオプションは移行の結果に直接影響を与える可能性があります。

#### 6. マッピングとフィルタリング

!['マッピング'](/image/plugins/plugin10.png)

- フィールド マッピングとは、2 つのテーブル間のデータ交換またはデータ同期のために、あるテーブルのフィールドを別のテーブルのフィールドにマッピングすることを指します。
MySQL データベース移行タスクの構成プロセス中に、ユーザーはターゲット ライブラリ内のライブラリ、テーブル、およびフィールドのオブジェクト マッピング名を設定できます。
以下の図に示すように、[テキストは濃い緑色で表示され、-sy サフィックスが追加されています] には、変更後の対象スキーマ、テーブル、およびフィールドのマッピング名が表示されます。

注: 変更されたマッピング名は英語の文字で始まる必要があります。長さは、英語の文字 (大文字と小文字が区別される)、数字、およびアンダースコアの組み合わせのみが許可されます。

!['マッピング'](/image/plugins/plugin11.png)

!['マッピング'](/image/plugins/plugin12.png)

移行が完了したら、ターゲット ライブラリに入り、ライブラリ、テーブル、フィールドがすべて、移行プロセス中に設定したマッピング名で表示されていることを確認します。

!['マッピング'](/image/plugins/plugin13.png)

- データ移行またはデータ複製において、移行またはコピーが必要なデータをフィルタリングして除外するために使用でき、不必要なデータの送信と処理を回避し、移行またはコピーの効率を向上させることができます。
次の図に示すように、MySQL データベース移行タスクの構成プロセス中に、[マッピングとフィルタリング] をクリックして、データ フィルタリング条件を自由に構成できるようにします。テキスト ボックスにフィルタリング条件を入力した後、テキスト ボックスの外に移動します。フィルタリング効果はフィルタリング結果のプレビューで確認できるため、ユーザーは期待どおりかどうかを確認できます。

!['マッピング'](/image/plugins/plugin14.png)

テーブルのフィルタリング条件を設定すると、そのフィルタリング条件は完全同期プロセスおよび増分同期プロセス中に自動的に組み込まれます。フィルタリングされたデータがターゲット側に同期されることが保証されます。
ここで設定した where フィルター条件は `CategoryId > 9` で、フィルター結果は次のようになります。
- ソースデータの表示:

!['マッピング'](/image/plugins/plugin15.png)

- 対象データ表示：

!['マッピング'](/image/plugins/plugin16.png)

ターゲット ライブラリは、「CategoryId > 9」のデータのみを同期しました。これはターゲットの期待と一致しています。

#### 7. 最終確認

- 移行先データベースに存在する同名のオブジェクトは再構築されますので、データの上書きや破損を避けるため、移行前に移行先データベースをよく確認してください。データ更新や DDL 変更の影響を軽減するために、オフピーク時間にデータ移行を実行することをお勧めします。

- 確認フェーズでは、ユーザーはプロンプト情報を確認し、データベースのバージョンの不一致によって引き起こされる可能性のある移行の失敗など、潜在的な問題やリスクを理解する必要があります。
同時に、事前チェックの結果を表示することもできます。エラーや警告がある場合は、移行を実行する前にこれらの問題を解決する必要があります。すべてが正常であれば、ユーザーは「タスクを保存して実行」をクリックして移行タスクを保存して実行するか、「タスクの保存」をクリックして関連する構成情報を一時的に保存できます。

!['確認'](/image/plugins/plugin17.png)

#### 8. 移行結果

- 移行が完了すると、ユーザーは移行の進行状況、ステータス、エラー メッセージなどを含む移行結果を表示できます。

!['結果'](/image/plugins/plugin18.png)

!['結果'](/image/plugins/plugin19.png)
